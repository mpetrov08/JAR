@model JobOfferDetailsViewModel
@inject IJobOfferService jobOffer;
@inject ICompanyService company;
@inject IJobApplicationService jobApplication;

@{
    ViewBag.Title = "Job Offer Details";
}

<h2 class="text-center text-primary mb-4">@ViewBag.Title</h2>
<hr />

<div class="container">
    <div class="row justify-content-center">
        <div class="card col-md-10 col-lg-8 shadow-lg rounded border-0">
            <div class="card-body">
                <div class="text-center mb-4">
                    @if (!string.IsNullOrEmpty(Model.Company.LogoUrl))
                    {
                        <img src="@Model.Company.LogoUrl" alt="@Model.Company.Name Logo" class="img-fluid rounded-circle" style="max-width: 250px; height: auto; transition: transform 0.3s ease;" />
                    }
                    <h3 class="text-primary mt-3">@Model.Title</h3>
                    <p class="text-muted"><i class="fas fa-calendar-alt"></i> Created on: @Model.CreatedOn</p>
                </div>

                <hr />

                <div class="mb-4">
                    <h4 class="text-secondary">Job Description</h4>
                    <div>@Html.Raw(Model.Description)</div>
                </div>

                <div class="mb-4">
                    <h4 class="text-secondary">Job Details</h4>
                    <ul class="list-unstyled">
                        <li><strong>Address:</strong> @Model.Address</li>
                        <li><strong>Category:</strong> @Model.Category</li>
                        <li><strong>Job Type:</strong> @Model.JobType</li>
                        @if (!string.IsNullOrEmpty(Model.RequiredLanguage))
                        {
                            <li><strong>Required Language:</strong> @Model.RequiredLanguage</li>
                        }
                        @if (!string.IsNullOrEmpty(Model.RequiredDegree))
                        {
                            <li><strong>Required Degree:</strong> @Model.RequiredDegree</li>
                        }
                        @if (!string.IsNullOrEmpty(Model.RequiredExperience))
                        {
                            <li><strong>Required Experience:</strong> @Model.RequiredExperience</li>
                        }
                        <li><strong>Required Skills:</strong> @Model.RequiredSkills</li>
                        <li><strong>Salary:</strong> @Model.Salary</li>
                    </ul>
                </div>

                <div class="mb-4">
                    <h4 class="text-secondary">Company Details</h4>
                    <h5 class="text-center text-primary">@Model.Company.Name</h5>
                    <ul class="list-unstyled">
                        <li><strong>Description:</strong> @Html.Raw(Model.Company.Description)</li>
                        <li><strong>Address:</strong> @Model.Company.Address</li>
                        <li><strong>Phone:</strong> @Model.Company.PhoneNumber</li>
                        <li><strong>Email:</strong> @Model.Company.Email</li>
                        <li><strong>Owner:</strong> @Model.Company.OwnerName</li>
                    </ul>
                </div>

                <div class="form-group d-flex justify-content-between">

                    @if(await jobOffer.HasCompanyWithIdAsync(Model.Id, User.Id()))
                    {
                        <a class="btn btn-outline-primary btn-lg shadow-sm hover-scale-up" asp-controller="JobOffer" asp-action="Edit" asp-route-id="@Model.Id">
                            <i class="fas fa-edit"></i> Edit
                        </a>
                        <a class="btn btn-outline-danger btn-lg shadow-sm hover-scale-up" asp-controller="JobOffer" asp-action="Delete" asp-route-id="@Model.Id">
                            <i class="fas fa-trash-alt"></i> Delete
                        </a>
                    }

                    
                    @if (!await company.OwnerCompanyExistsAsync(User.Id())
                    && User.Identity.IsAuthenticated)
                    {
                        <a class="btn btn-outline-success" asp-area="" asp-controller="Rooms" asp-action="Create" asp-route-name="@Model.Title" asp-route-companyOwnerId="Model.CompanyOwnerId">Start Chat</a>

                        @if (await jobApplication.HasUserAlreadyAppliedAsync(Model.Id, User.Id()))
                        {
                            <a class="btn btn-outline-primary" asp-area="" asp-controller="JobApplication" asp-action="CheckStatus" asp-route-jobId="@Model.Id">Check Status</a>
                        }
                        else
                        {
                            <a class="btn btn-outline-primary" asp-area="" asp-controller="JobApplication" asp-action="Apply" asp-route-id="@Model.Id">Apply for Job</a>
                        }
                    }
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
}

@section Scripts {
    <partial name="_ValidationScriptsPartial"></partial>
}